# network request

#### axios

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * axios
 * 
 * 
 * 客户端 和服务器端都可以使用
 * 可以在 请求 和 相应阶段 进行拦截
 * 基于 promise 对象
 */


axios({
    method: 'post',
    url: '/user/12345',
    data: {
        firstname: 'fred',
        lastname: 'flintstone'
    }
})
.then((res) => {

    console.log(res);
})
.catch((err) => {

    console.log(err);
});


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


1）从 node.js 创建 http 请求，在浏览器中创建 xmlhttprequests，在 node.js 则创建 http 请求( 自动性强 )

2）支持 promise api，支持拦截请求和响应

3) 自动转换 json 数据

4) 客户端支持防止 csrf，xsr


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### fetch

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * fetch
 * 
 * 
 * 基于 es6 中的 promise对象 设计的，没有使用 xmlhttprequest 对象
 */


// fetch 是比较底层的 api，很多情况下都需要再次封装

fetch(url, {
    method: 'post',
    body: object.keys({name: 'test'}).map((key) => {
        return encodeuricomponent(key) + '=' + encodeuricomponent(params[key]);
    }).join('&')
})


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


1) fetch 只对网络请求报错，对 400，500 都当作成功的请求，需要进行封装处理

2) fetch 默认不会带 cookie,需要添加配置项

3) fetch 不支持 abort，不支持超时控制，使用 settimeout 及 promise.reject 的实现的超时控制并不能阻止请求过程继续在后台运行，造成了流量的浪费

4) fetch 没有办法原生监测请求的进度，而 xhr 可以


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### ajax

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * asynchronous javascript and xml
 * 
 * 
 * 
 */


$.ajax({
   type: 'post',
   url: url,
   data: data,
   datatype: datatype,
   success: function () {},
   error: function () {}
});


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


1) 本身是针对 mvc 的编程,不符合现在前端 mvvm 的浪潮

2) 基于原生的xhr开发，xhr 本身的架构不清晰，已经有了 fetch 的替代方案

3) jquery 整个项目太大，单纯使用 ajax 却要引入整个 jquery 非常的不合理( 采取个性化打包的方案又不能享受cdn服务 )

4) CSRF（Cross-site request forgery）跨站请求伪造，Cross-Site Scripting（跨站脚本攻击）简称 XSS，是一种代码注入攻击


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### xmlhttprequest

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * xmlhttprequest
 * 
 * 
 * 
 */


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

