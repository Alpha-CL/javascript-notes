# git

#### introduction

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * Git 分布式版本控制系统
 * 
 * 
 * 版本控制系统( version control syetem )
 */


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


.git/
  |
  |-- HEAD              // 资源引用指针: 指向本地仓库的当前引用的分支( HEAD 初始化默认指向 master 分支 )
  |
  |-- branches          // 分支仓库
  |
  |-- config            // git config 的配置信息页
  |
  |-- description       // 供 gitweb ( github  的一种前身) 使用，显示仓库的描述
  |
  |-- hooks             // 可以在 commit, rebase, pull 操作的前后运行后运行的一些脚本
  |     |
  |     |-- applypatch-msg.sample
  |     |-- commit-msg.sample
  |     |-- fsmonitor-watchman.sample
  |     |-- post-update.sample
  |     |-- pre-applypatch.sample
  |     |-- pre-commit.sample
  |     |-- pre-push.sample
  |     |-- pre-rebase.sample
  |     |-- pre-receive.sample
  |     |-- prepare-commit-msg.sample
  |     |-- update.sample
  |
  |
  |-- index             // 保存暂存区信息
  |
  |
  |-- info              // 可以将不想被 git 管理的文件记录到 .gitignore 文件中
  |     |
  |     |-- exclude     // 用于全局排除 想要忽略文件的记录
  |
  |
  |-- logs              // 保存日志信息
  |
  |
  |-- objects           // 存储对象的目录( 本地仓库) git中对象分为三种: commit对象, tree对象(多叉树), blob对象
  |     |
  |     |-- info
  |     |-- pack
  |
  |
  |-- refs              // 存储指向 branch 的最近一次 commit对象 的 HEAD指针
  |     |
  |     |-- heads
  |     |-- tags
  |


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 提交过程的原理
 * 
 * 
 */

1) 在 工作目录( WorkSpace ) 中添加、修改文件

2) 将需要进行版本管理的 文件或文件夹 放入 暂存区( stage )

3) 将 暂存区( stage ) 中指定或所有的 对文件的添加，修改等操作 作为一次版本 提交到 本地git仓库( Repository )

4) 将 本地版本库( Repository ) 中一次版本文件提交到 git远程仓库( Remote )


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


        + ---------- +
        |            |                                    pull
        |            | -------------------------------------------------------------------------- + 
        |            |                                                                            |
        |            |                                                                           \|/
        |            |                  + ------------ +                                   + ----------- +
        |            |                  |              |             checkout              |             |
        |            |                  |              | --------------------------------> |             |
        |            |      fetch       |              |                                   |             |
        |            |      clone       |              |            + ------- +            |             |
        |            | ---------------> |              |            |         |            |             |
        |            |                  |              |            |         |            |             |
        |   Remote   |       push       |  Repository  |   commit   |  Index  |    add     |  Work Tree  |
        |            | <--------------- |              | <--------- |  stage  | <--------- |             |
        |            |                  |              |            |         |            |             |
        + ---------- +                  + ------------ +            + ------- +            + ----------- +

                                                                     git status
                                                                    
          Git远程仓库                        本地版本库                  本地缓存区                 本地工作区



        WorkSpace( 工作区 )        // 
        
        Index/Stage( 缓存区 )      // 
        
        Repository( 版本库 )       // 
        
        Remote( 远程库 )           // 


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

## config

#### view config

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 查看 git 所有配置项
 * 
 * 
 */

git config --list


//-------------------------------------------------------------------------------------------------------------------//


/**
 * config 配置有 3 个级别
 * 
 * 
 * systetm          // 系统
 * global           // 用户
 * local            // 仓库
 */


git config --system --list          // 获取 系统级别 配置信息

git config --global --list          // 获取 用户级别 配置信息 

git config --local --list           // 获取 仓库级别 配置信息 


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 根据指定级别，修改指定配置信息
 * 
 * 
 * @level: system | global | local
 */

git config --[level] [key]                  // get

git config --[level] [key] [val]            // set


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 删除指定配置信息
 * 
 * 
 * @level: system | global | local
 */

git config --[level] --unset [key]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### user

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 配置用户名
 * 
 * 
 * @level: system | global | local
 */

git config --[level] user.name [username]        // set

git config --[level] user.name                   // get


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### email

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 配置用户邮箱
 * 
 * 
 * @level: system | global | local
 */

git config --[level] user.email [email]          // set

git config --[level] user.email                  // get


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

## command

#### init

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 初始化 git
 * 
 * 
 * 在项目根目录下创建一个.git子目录，用来保存版本信息
 */

git init


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### add

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 将文件放入暂存区进行追踪
 * 
 * 
 * 
 */


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// 已跟踪

指已被纳入了版本控制的文件，在上一次快照中有它们的记录
在工作一段时间后，它们的状态可能处于未修改，已修改或已放入暂存区
初次克隆某个仓库的时候，工作目录中的所有文件都属于已跟踪文件，并处于未修改状态


// 未跟踪

工作目录中除已跟踪文件以外的所有其它文件都属于未跟踪文件
它们既不存在于上次快照的记录中，也没有放入暂存区


untracked           unmodified          modified            staged
  未追踪                未修改              修改的               阶段

|------------------------- add the file ------------------------->|
|                                                                 |
|                   |---- edit the file ------->|                 |
|                                                                 |
|                                       |---- stage the file ---->|
|                                                                 |
|<----- remove the file -----|                                    |
|                                                                 |
|                   |<------------------- commit -----------------|


无论是 Untracked 或 Modified 状态的文件最终都需要转换成 Staged 状态的文件才能被 Git管理
一般称 Staged状态 的文件为存入暂存区的文件


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


git add [<options>] [--] <pathspec>...


git add .           // include: [modified] & [untracked]
                    // unclude: [delete file]

git add -A          // [all tracked file] & [delete and new untracked file]

git add -u          // include: [modified and delete of untracked file]
                    // unclude: [new file]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### rm

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * git rm [file]
 * 
 * 
 * 同时从工作区和索引中删除文件，即本地的文件也被删除了
 */


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * git rm --cached [file]
 * 
 * 
 * 从索引中删除文件，但是本地文件还存在
 * 只是不希望这个文件被版本控制
 */



///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### status

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 显示工作目录和暂存区的状态
 * 
 * 
 * 
 */

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


Untracked           UnModified          Modified            Staged
  未追踪                未修改              修改的               阶段

|------------------------- add the file ------------------------->|
|                                                                 |
|                   |---- edit the file ------->|                 |
|                                                                 |
|                                       |---- stage the file ---->|
|                                                                 |
|<----- remove the file -----|                                    |
|                                                                 |
|                   |<------------------- commit -----------------|


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


git status -s


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


A: 你本地新增的文件（服务器上没有）
    
C: 文件的一个新拷贝

D: 你本地删除的文件（服务器上还在）

M: 文件的内容 或者 mode 被修改了

R: 文件名被修改了

T: 文件的类型被修改了

U: 文件没有被合并( 你需要完成合并才能进行提交 )

X: 未知状态( 很可能是遇到git的bug了，你可以向git提交bug report )

?: 未被git进行管理，可以使用git add file1把file1添加进git能被git所进行管理


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### restore

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * get restore [file]
 * 
 * 
 * 将不在暂存区的文件撤销更改
 */

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * git restore --staged [file]
 * 
 * 
 * 将暂存区的文件从暂存区撤出，但不会更改文件
 */


//-------------------------------------------------------------------------------------------------------------------//


// 对于 git restore --staged <file>命令，把文件从暂存区撤回到工作区，保留文件最后一次修改的内容

// 对于 git restore <file> 命令，会撤销文件的修改，使文件恢复到暂存区或本地代码库( 取决于文件在修改前的状态 )


1、文件在暂存区且未作修改的情况

使用 git restore --staged <file> 把文件从暂存区移动到工作区，即文件不被追踪


2、文件在暂存区且已经修改的情况

使用 git restore --staged <file> 把文件从暂存区移动到工作区，且不会撤销修改的内容

使用git restore <file> 文件仍在暂存区且会撤销文件修改的内容；


3、文件在本地代码库已经修改的情况

使用git add <file> 把文件重新放到暂存区，且保留文件的修改；

使用git restore <file> 文件仍在本地代码库且会撤销文件的修改；


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### commit

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 根据当前文件提交
 * 
 * 
 * 会将当前文件暂时放入本地仓库存储
 */

git commit -a -m [message]          // 将缓存区的所有改动提交到本地仓库作为一次版本，并填写版本描述信息

git log --online                    // 查看所有提交过的版本信息( 不包括 已经被删除的 commit, reset )

git reflog                          // 显示所有的操作记录( 包括 commit, reset ), 一般用来找出操作记录中的版本号，进行回退


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### git reflog & git log

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * git reflog
 * 
 * 
 * 显示所有的操作记录，包括提交，回退的操作
 * 
 * 一般用来找出操作记录中的版本号，进行回退
 */


//-------------------------------------------------------------------------------------------------------------------//


/**
 * git log
 * 
 * 
 * 显示所有提交过的版本信息
 * 
 * 不包括已经被删除的 commit 记录和 reset 的操作
 */


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### reset

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 暂存区文件撤销( 不覆盖工作区 )
 * 
 * 
 */

git reset HEAD [file]


//-------------------------------------------------------------------------------------------------------------------//


/**
 * 版本回退             // 重置 HEAD  指向
 * 
 * 
 * --hard: 回退全部，包括 HEAD, index/stage, working-tree      // 慎用
 * 
 * --mixed: 回退部分, 包括 HEAD, index/stage
 * 
 * --soft: 只回退 HEAD
 */


git reset --(hard | mixed | soft) [HEAD~number | [commit hash]]

git reflog              // 显示所有的操作记录( 包括 commit, reset ), 一般用来找出操作记录中的 commit id，进行回退

git log                 // 显示所有提交过的版本信息( 不包括已经被删除的 commit 记录和 reset 的操作 )


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### checkout

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 撤销工作区修改
 * 
 * 
 */


将 file 在工作区的修改全部撤销

1) file 自修改后还未放置到 暂存区，则撤销修改，回退至 版本库 一样的状态

2) file 已经添加到 暂存区，并做了修改，若撤销修改，则回退至 添加到 暂存区后的状态


git checkout -- [file]


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// 新建并切换至该分支

git checkout -b [new branch] == git brancha [new branch] + git switch [new branch]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### remote

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 新增本地本地 git 的远程仓库地址
 * 
 * 
 * 
 */


git remote add [origin] [address]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### diff

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 比较 工作区和 暂存区
 * 
 * 
 */

git diff


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 比较 工作区 和 本地版本库中 最近一次 commit 的内容
 * 
 * 
 */

git diff HEAD


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//



/**
 * 比较 暂存区 和 本地版本库中 最近一次 commit 的内容
 * 
 * 
 */

git diff -- cached


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 比较两个 commit 之间的差异
 * 
 * 
 */

git diff [commit id] [commit id]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### branch

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 创建新分支，并直接切换至新分支
 * 
 * 
 */

git checkout -b [new branch name] == git branch [branch] + git checkout [branch]


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 根据 指定分支名 切换分支
 * 
 * 
 */

git checkout [branch name]

git switch [branch name]


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 查看当前工程的所有分支
 * 
 * 
 */

git branch

git branch -a           // 查看所有分支( 包含远程分支 ) 


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 根据 指定分支名 创建新的分支
 * 
 * 
 */

git branch [branch name]


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 根据 指定分支名 删除的分支
 * 
 * 
 */

git branch -d [branch name]


//-------------------------------------------------------------------------------------------------------------------//


/**
 * 合并无冲突分支
 * 
 * 
 */

git merge [branch]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### gitk & git gui

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 
 * 
 * 
 * 
 */


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### clone & push & pull

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 将远程仓库的代码克隆到本地
 * 
 * 
 */

git clone [url]


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 将 本地仓库中 的代码提交至远程 git仓库
 * 
 * 
 */

git push

git push orign [master/main/xxx]


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 取回远程主机某个分支的更新，再与本地的指定分支合并
 * 
 * 
 */

git pull [username] [remote branch]:[local branch]      // 若远程分支是与当前分支合并，则冒号后面的部分可以省略

git pull origin master                                  // 将远程 [origin主机] 的 [master分支] 拉取过来和本地的当前分支进行合并


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 仅将 git远程仓库中的 指定分支取回，并不作合并
 * 
 * 可通过 git log -p FETCH_HEAD 查看分支更新的信息后，再决定是否合并
 * 
 */

git fetch [username] [remote branch]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```


