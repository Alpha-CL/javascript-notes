# Event

触发顺序: 先捕获，后冒泡; 特殊情况( 执行优先: 当前对象事件先执行, 会提升至于冒泡之前 ) 

> IE 没有事件捕获

一个对象的事件类型，只能存在一种事件模型( 冒泡/捕获 )

非事件冒泡事件: focus, blur, change, submit, reset, select ...

``` javascript


<div class="GrandFather">

    <div class="Father">
    
        <div class="Son"></div>
    </div>
</div>


```

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


               /**
                * 当一个元素发生了某个事件时，那该元素的所有祖先元素都发生了该事件
                * 
                * 事件冒泡: 先触发最里层的元素，然后依次触发外层元素           // 默认情况
                * 
                * 事件源:   目标事件
                * 
                * 事件捕获: 先触发最外层的元素，然后依次触发里层元素
                */
                

               /**
                * addEventListener
                * 
                * 1) 可以为某个元素的同一事件，添加多个处理函数，按照注册的先后顺序执行
                * 2) 允许控制事件的触发顺序( 捕获/冒泡 )，若为事件源( 目标事件 )，则无法控制触发顺序( 第三个参数无效 )
                * 
                * 
                * removeEventListener
                * 
                * 1) 允许移除事件处理函数
                * 2) 无法移除匿名事件函数
                */ 


               /**
                * adEventListener(type,handle,{
                * 
                *       caputer: true,                  // 是否为捕获阶段
                *       once: true                      // 是否只执行一次
                * })
                */


                                    + --------------------- +
                                    |                       |
               -    (1)     + ------|       document        | ------ +      (9)     -             
               |            |       |                       |        |\             |         
               |            |       + --------------------- +        |              |     
               |            |                                        |              |     
               |            |       + --------------------- +        |              |     
               |           \|       |                       |        |              |     
               |    (2)     + ------|         html          | ------ +      (8)     |             
               |            |       |                       |        |\             |         
               |            |       + --------------------- +        |              |                                 
               |            |                                        |              |                     
               |            |       + --------------------- +        |              |                 
               |           \|       |                       |        |              |                 
      capture  |    (3)     + ------|         body          | ------ +      (7)     |   bubble                         
               |            |       |                       |        |\             |                     
               |            |       + --------------------- +        |              |                 
               |            |                                        |              |                     
               |            |       + --------------------- +        |              |                 
               |           \|       |                       |        |              |                 
               |    (4)     + ------|         div           | ------ +      (6)     |                             
               |            |       |       (father)        |        |\             |                     
               |            |       |                       |        |              |                 
               -            |       + --------------------- +        |              -                 
                            |                                        |                                              
                            |                                        |                                              
                            |       + --------------------- +        |                               
                           \|       |                       |        |                               
                            + ------|        button         | ------ +                               
                                    |       (target)        |
                                    |                       |
                                    + --------------------- +

                                               (5)

                                    |-----------------------|
                                              
                                             trigger



///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

## Add Event

#### Event bubbling phase -- default

事件冒泡: 结构(非视觉上) 嵌套关系的元素，会存在事件冒泡的功能，即同一事件，自子元素冒泡向父元素

EventExecuteOrder: Son -> Father -> GrandFather

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


element.addEventListener(event, function, false)；


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### Event capturing phase 

> 仅 Chrome 上好使

事件捕获: ( 非视觉上 ) 嵌套关系的元素，会存在事件捕获的功能，即同一事件，自父元素捕获至子元素( 事件源元素 )

EventExecuteOrder: GrandFather -> Father -> Son
    

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


element.addEventListener(event, function, true);


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

***

## Event Parameter

#### MouseEvent

> 非 IE 浏览器

当与HTML文档交互鼠标属于MouseEvent对象发生的事件

MouseEvent接口继承了Event接口，所以拥有Event的所有属性和方法。它还有自己的属性和方法。

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 事件参数 e
 * 
 * 用户与指针设备( 如鼠标 ) 与浏览器发生交互时浏览器会创建一个 MouseEvent{} 用于存储用户的操作的事件
 */

MouseEvent{

    onclick,                                // 当用户单击元素时发生事件
    oncontextmenu,                          // 当用户右键单击元素以打开上下文菜单时，将发生该事件
    ondblclick,                             // 当用户双击元素时发生事件
    onmousedown,                            // 当用户在元素上按下鼠标按钮时，发生事件
    onmouseenter,                           // 当指针移动到元素上时，发生该事件
    onmouseleave,                           // 当指针从元素中移出时发生该事件
    onmousemove,                            // 当指针在元素上方移动时发生该事件
    onmouseout,                             // 当用户将鼠标指针移出某个元素或其子元素之一时，将发生该事件
    onmouseover,                            // 当指针移动到元素或其子元素之一上时，发生此事件
    onmouseup,                              // 当用户在元素上释放鼠标按钮时，发生该事件
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### window.event

> IE 浏览器存储在 window.event 中

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 事件参数 e
 * 
 * 用户与指针设备( 如鼠标 ) 与浏览器发生交互时浏览器会创建一个 MouseEvent{} 用于存储用户的操作的事件
 */

window.event{

    onclick,                                // 当用户单击元素时发生事件
    oncontextmenu,                          // 当用户右键单击元素以打开上下文菜单时，将发生该事件
    ondblclick,                             // 当用户双击元素时发生事件
    onmousedown,                            // 当用户在元素上按下鼠标按钮时，发生事件
    onmouseenter,                           // 当指针移动到元素上时，发生该事件
    onmouseleave,                           // 当指针从元素中移出时发生该事件
    onmousemove,                            // 当指针在元素上方移动时发生该事件
    onmouseout,                             // 当用户将鼠标指针移出某个元素或其子元素之一时，将发生该事件
    onmouseover,                            // 当指针移动到元素或其子元素之一上时，发生此事件
    onmouseup,                              // 当用户在元素上释放鼠标按钮时，发生该事件
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### 获取兼容 e

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


var div = document.getElementsByTagName('div')[0];

div.onclick = funciton(e) {

    var event = e || window.event;
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### Event Source Object

获取事件源对象

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 触发事件时 MouseEvent / window.event 会记录事件的源对象
 * 
 */

MouseEvent / windwo.event {

    srcElement: eventSourceObj,                     // 事件源对象            // 谷歌 IE
    target: eventSourceObj,                         // 事件源对象            // 火狐
    
    ... ...
}


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 获取兼容事件源对象
 * 
 */

var div = document.getElementsByTagName('div')[0];

div.onclick = funciton(e) {

    var targe = event.targe || event.srcElement;
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```


## Cancel Event

#### e.stopPropagation();

W3C 标准 event.stopPropagation(); 但不支持 ie9 以下版本


``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


var div = document.getElementsByTagName('div')[0];

div.onclick = funciton(e) {

    e.stopPropagation();
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### e.cancelBubble = true;

IE独有，event.cancelBubble = true;


``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


var div = document.getElementsByTagName('div')[0];

div.onclick = funciton(e) {

    
    e.cancelBubble = true;
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### 封装取消冒泡函数

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * stopBubble(e);
 * 
 */

function stopBubble(event) {

    if(event.stopPropagation) {
    
        event.stopPropagation();
        
    } else {
    
        event.cancelBubble = true;
    }
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

*** 

## Prevent Event

#### return false;

以对象的方式注册的事件才生效

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


document.oncontextmenu = function() {

    return false;
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### event.preventDefault();

W3C 标准， IE9及以下不兼容

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


document.oncontextmenu = function(e) {

    e.preventDefault();
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### event.returnValue = false;

兼容 IE

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


document.oncontextmenu = function(e) {

    e.returnValue = false;
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### 封装阻止默认事件兼容代码

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


function cancelHandler(event) {

    if(event.preventDefault) {
    
        event.prevetDefault;
    
    } else {
    
        event.returnValue = false;
    } 
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### 阻止 a 链接默认事件

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * a 标签有跳转 和 默认点击后返回页面顶部的事件
 * 
 */

<a href="http://www.baidu.com">baidu</a>


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//



var a = document.getElementsBayTagName('a')[0];

a.onclick = function() {

    return false;
}


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


<a href="javascript: void();">baidu</a>


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```




