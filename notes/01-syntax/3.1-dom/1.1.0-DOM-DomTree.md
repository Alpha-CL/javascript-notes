# Document Object Mode

DOM 定义了表示和修改 document( 页面顶级对象 ) 所需的方法

DOM对象 及为宿主对象，由浏览器厂商定义，用来操作 html 和 xml 功能的一类对象的合集

DOM 也称为 HTML 以及 XML 的标准编程接口

#### Javascript 分为三个部分

ECMAScript 标准: JS 的基本语法

DOM( Document Object Model ) -> 文档对象类型 -> 操作页面的元素: document( 页面顶级对象 )

BOM( Browser Object Model ) -> 浏览器对象模型 -> 操作浏览器: window( 浏览器顶级对象 )

    
#### API( Application Programming interface 应用程序编程接口 )

> API（Application Programming Interface,应用程序编程接口）是一些预先定义的函数，目的是提供应用程序与开发人员基于某软件或硬件得以访问一组例程的能力，而又无需访问源码，或理解内部工作机制的细节

是一些预定义的函数，目的是提供应用程序与开发人员基于某软件或硬件得以访问一组例程的能力

又无须访问源码，或理解内部工作机制的细节

> 任何开发语言都有自己的 API
> 
> API 的特征 输入 和 输出 ( I / O )
> 
> API 的使用方法 console.log();


#### Web API

浏览器提供的一套操作浏览器功能和页面元素的 API ( BOM & DOM )

此处的 API 特指浏览器提供的 API ( 一组方法 )
      

#### DOM

window 是浏览器的顶级对象，当调用 window 下的属性和方法时，可以省略 window 注意：window 下一个特殊的属性 window.name

__概念__

> 把一个 html 文件看成一个文档，万物皆对象，所以把这个文档堪称是一个对象
> 
> HTML: 展示信息，展示数据 
> 
> XML: 侧重于存储数据

文件也可以看成是一个 文档

2007 之后的文档，把后缀改成 rar 解压后就是 XML 文件

html 文件看成是一个文档，那么这个 "文档" 可以看成是一个 "对象"，文档中的 "所有的标签" 都可以看成是一个 "对象"

页面中的每个标签，都是一个元素( element )，"每个元素" 都可以看成是一个 "对象"

html 页面中都有一个根标签 < html > ，里面有很多的元素( 有很多的 "标签"，有很多的 "对象" )

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// 页面中的顶级对象: document( 一个页面就是一个文档 )

document            // 文档


// 页面中的根标签 html标签

root                // 根


// 页面中 "所有的内容" 都是 "节点"

node                // 节点
    

// 页面中的所有的标签都是元素，"元素" 可以看成是 "对象"

element             // 元素

   
// 属性

property            // 属性


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### DOM 树

由文档及文档中的所有的元素( 标签 )组的一个树形结构图，叫树状图( DOM树 )

* 把 html 页面 或者 XML 文件看成是一个文档，文档就是一个对象

* 文档中所有的标签都是元素，元素也可以看成是对象

* 标签( 元素，对象 )有很多，还有嵌套的关系

* 组成的这种层次结构，可以模拟成树形结构图( 简称: 树状图 == DOM 树 )


``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


    // DOM 树

                                     + ----------- +
                                     |             |
                                     |  Documeent  |
                                     |             |
                                     + ----------- +
                                            |       
                                   + --------------- +
                                   |                 |
                                   |   Root element  |
                                   |      <html>     |
                                   |                 |
                                   + --------------- +
                                            |
           + ------------------------------ + --------------------------- +    
           |                                                              |
    + ------------ +                                               + ----------- +
    |              |                                               |             |
    |   Element    |                                               |   Element   |
    |   <head>     |                                               |   <body>    |
    |              |                                               |             |
    + ------------ +                                               + ----------- +
           |                                                              |
           |                                                  + --------- + ----------- +
           |                                                  |                         | 
    + ------------ +           + ----------- +         + ----------- +          + ------------- +
    |              |           |             |         |             |          |               |
    |   Element    |           |  Attribute  | ------- |   Element   |          |    Element    |
    |   <title>    |           |   "href"    |         |     <a>     |          |      <h1>     |
    |              |           |             |         |             |          |               |
    + ------------ +           + ----------- +         + ----------- +          + ------------- +
           |                                                  |                         |
           |                                                  |                         | 
    + ------------ +                                   + ----------- +          + ------------- +
    |              |                                   |             |          |               |
    |     Text     |                                   |    Text     |          |     Text      |
    |  "My title"  |                                   |  "My link"  |          |  "My header"  |
    |              |                                   |             |          |               |
    + ------------ +                                   + ----------- +          + ------------- +


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```


#### renderTree

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


                                     + --------- +
                                     |           |
                                     |    DOM    |
                                     |           |
                                     + --------- +
                                           |
                                           |
    + -------- +    + ---------- +    + -------- +      + ---------- +
    |          |    |            |    |          |      |            |
    |   HTML   |    |    HTML    |    |   DOM    |      |   Layout   |
    |          |----|   Parser   |----|   Tree   |      |            |
    |          |    |            |    |          |      |            |
    + -------- +    + ---------- +    + -------- +      + ---------- +
                                           |                   |
                                           |                   |
                                  + -------------- +    + ---------- +    + ------------ +    + ----------- +
                                  |                |    |            |    |              |    |             |
                                  |   Attachment   |    |   Render   |    |   Painting   |    |   Display   |
                                  |                |----|   Tree     |----|              |----|             |
                                  |                |    |            |    |              |    |             |
                                  + -------------- +    + ---------- +    + ------------ +    + ----------- +
                                           |
                                           |
    + ---------- +   + ---------- +   + --------- +
    |            |   |            |   |           |
    |   Style    |   |   CSS      |   |   Style   |
    |   Sheets   |---|   Parser   |---|   Rules   |
    |            |   |            |   |           |
    + ---------- +   + ---------- +   + --------- +


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * css 属性值计算过程
 * 
 * 从元素本身确定声明( 元素是否继承要从元素本身开始思考，并不是父级 )
 * 
 * propertyName: inherit;               // 强制继承父级指定声明属性值
 *               initial;               // 使用元素默认值
 */

     start         1.确定声明                   3.使用继承                          
    
    无属性值 ---------- + ---------- + ------------ + ---------- + ----------> 每个属性都有值
    
                                2.层叠冲突                   4.使用默认              end


    1.确定声明: 选择出无权重纠纷的样式直接作为 css 属性值
    
    2.层叠冲突: 比较权重，获取最终样式
    
    3.使用继承: 对仍然没有值的声明属性，若可以继承，则继承父元素的值
    
    4.使用默认: 对仍然没有值的属性，使用默认值


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * domTree & cssTree 结构 类似
 * 
 * renderTree: 渲染树，每个节点附近都带有 css 属性，以便于构建页面         // 仅绘制需要绘制的元素结构( eg: display: none; 去除 )
 */


             // 修改部分 CSS 样式，会先改变 cssTree，然后修改 renderTree 上对应 Node 的属性( css ) 即可   
             
            | --> repaint( 重绘 ) -> 影响效率较少                              // repaint
            |        |
            |        | --> color
            |        | 
            |        | --> width / height ...
            |
            |
domTree + cssTree => renderTree -> 辨识 Node -> 深度优先解析
   |                            ｜                           => end => domTree 解析完毕
   |                            -> 异步加载 img 等
   |
   |
   |         // 修改 DOM 节点会重排 renderTree( reflow: 页面重构 ) -> 影响效率较多         
   |                     
   + ---> change DomNode -> domTree => reflow(重排) -> renderTree             // reflow -> repaint              
            ｜
            ｜
            ｜--> 节点( 删除 / 添加 )
            ｜
            ｜--> dom 节点的宽高变化，display( none / block )
            ｜
            ｜--> offsetWidth offsetLeft                


=> layout( 布局 ) => paint( 绘制 ) => 逻辑上( 多层矢量图 ) => 实际绘制( 删格化 ) => Set Browser (CPU | GPU) paint


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```


#### 初识 DOM 操作

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


var count = 0;

div.onclick = function() {

    count++;
    
    if(count % 2 == 1) {                                // 想要几种效果切换都可以 count % n 
    
        this.style.backgroundColor = 'green';           // 第一次点击时的效果

    } elst {
    
        this.style.backgroundColor = 'red';             // 第一次点击时的效果
    }
};

console.log(sum);                                       // 99


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```