#

#### directory

```javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// 强制类型转换


- 显式强制类型转换: 代码逻辑清晰易读

Number();

String();

Boolean();


- 隐式类型转换: 减少冗余, 使代码更简洁

+str;                   // number

num + '';               // string

!num;                   // boolean


//-------------------------------------------------------------------------------------------------------------------//



// 原始值封装对象

    - Number();
    - String();
    - Boolean();


// 获取原始值的值

    - valueOf();
    - toString();


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// principle


ToString(originalValue);             // 将 其他类型的原始值 转换为 字符串
ToNumber(originalValue);             // 将 其他类型的原始值 转换为 数字
ToBoolean(originalValue);            // 将 其他类型的原始值 转换为 布尔值

ToPrimitive(referenceValue);         // 将引用值转换为原始值


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

## implicit

### ToString();

#### introduction

```javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * ToString(): string | null;
 *
 *
 * 负责处理将非字符串类型 强制转换为 字符串
 */


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


ToString(null);             // 'null'
ToString(undefined);        // 'undefined'
ToString(true);             // 'true'


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// toString();


- Object.toString() 的方法返回目标类型

    Object.prototype.toString(): [object type];

    eg:
        {}.toString();              // [object Object]


- 部分系统构造函数的 toString(); 方法被重写为用于 转换为字符串的方法

    Number.toString();            // 重写
    Boolean.toString();           // 重写
    ...

    eg: 
        1.toString();               // '1'
        'a'.toString();             // 'a'
        true.toString();            // 'true'
        new Date().toString();      // 'Thu Mar 28 2019 17:07:40 GMT+0800 (中国标准时间)'
        /\d/.toString();            // '/\d/'
        [1,2,3].toString();         // '1,2,3'
        function(){}.toString();    // 'function(){}'


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// valueOf();


1.valueOf();                        // 1
'a'.valueOf();                      // 'a'
true.valueOf();                     // true
new Date().valueOf();               // 1553766610534
/\d/.valueOf();                     // /\d/
[1,2,3].valueOf();                  // ['1,2,3']
function(){}.valueOf();             // function(){}


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// Operator precedence


1) . [] {}                                      // 字段访问, 数组索引访问,

2) ++ -- + - delete new typeOf void             // 一元运算符, 返回数据类型, 创建对象, 未定义

3) * / %                                        // 乘法, 除法, 取模

4) + - +                                        // 加法, 减法, 字符串连接

5) << >> >>>                                    // 移位

6) < <= > >= instanceof                         // 大于, 小于等于, 小于, 小于等于

7) == != === !==                                // 等于

8) &                                            // 位运算: 与

9) ^                                            // 为运算: 或

10) &&                                          // 逻辑运算: 与

11) ? :                                         // 三元运算

12) = oP=                                       // 赋值, 运算赋值

13) ,                                           // 多重求值



//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//

// conversion rules


/**
 * ToPrimitive(hint);
 * 
 * 
 * 
 ** DefaultValue:
 *
 * @hint: 期望转换的类型( def: Number )
 * 
 * 
 *  - Number: 
 * 
 *  - String/Number: 先判断 toString 能否调用, 再判断 toString(); 的返回结果是否是原始值
 *                   再判断 valueOf(); 是否调用, 再判断 valueOf(); 的返回结果是否是原始值 
 *                   否则报错
 * 
 *  - Object: 
 * 
 *      - default: ToNumber
 * 
 *      - Date( object ): ToString
 *
 */


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// Array.prorotype.toString();              // 返回以逗号分割的数组子项的字符串


let arr = [1, 2, , 3];

arr.toString();         // '1,2,3'


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### JSON.stringify();

```javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// JSON.stringify();             // 隐式调用 toString();


JSON.stringify(42);             // "42"
JSON.stringify("42");           // ""42""
JSON.stringify(null);           // "null"
JSON.stringify(true);           // "true"


// undefined, funcution, symbol => null

以上值属于不安全的 JSON 值( 对象之间的互相引用, 可能形成无线循环 )
JSON.stringify(); 会自动忽略它们, 若它们出现在数组中，则会使用 null 占位


JSON.stringify(undefined);                          // "undefined"
JSON.stringify(funcution(){});                      // "undefined"
JSON.stringify([undefined, funcution(){}]);         // [null, null]


//-------------------------------------------------------------------------------------------------------------------//


/**
 * toJSON();        // 返回安全的JSON值
 *
 *
 * JSON 序列化时, 会首先调用该内置方法返回安全的JSON值，再用其返回的值进行序列化
 *
 ** 不安全的JSON值: undefined, funcution, symbol => null
 */


- 若对含有 非法JSON 值的对象做字符串化, 则会调用该方法

- 对象中的某些值无法被序列化时, 则会调用该方法

  ( "不安全的 JSON 值( undefined, funcution, symbol )" 会被转换为 null )


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * JSON.stringify(target, replacer?);
 *
 *
 * @replacer: 指定对象序列化过程中哪些属性应该被处理，哪些该排除
 *
 *      - array<string>:
 *
 *      - funcution:
 *
 * 不是强制类型转换
 */


1) JSON.stringify(string, number, boolean, null) === ToString(string, number, boolean, null)

2) 若传递给 JSON.stringify() 的对象定义了 toJSON();
   那么该方法互殴在字符串化前调用, 以便转换为安全的JSON值


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

### ToNumber();

#### introduction

```javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * ToNumber();
 *
 *
 * 负责处理将非字符串类型 强制转换为 数字
 */


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


ToNumber(true); // 1
ToNumber(false); // 0
ToNumber(undefined); // NaN
ToNumber(null); // 0


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### string to number

```javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * ToNumber(string): number | NaN;
 *
 *
 * 针对字符串转为数字( 遵循数字常量的相关规则 ), 处理失败则返回 NaN
 *
 ** 针对以 0 开头的字符串作为 进制处理
 */


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### object of number

```javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * ToNumber(object);
 *
 *
 * 对象( 数组 )会首先被转换为相应的基本值
 * 若返回的是非数字的基本单位，则会再次遵循以上规则将其强制转换为是数字
 */


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

### ToPrimitive();

#### introduction

```javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * ToPrimitive();
 *
 *
 * 将值转换为相应的基本类型的值
 */


1) 首先调用内置的 DefaultValue 检查是否有 valueOf(); 方法

    - 有: 则返回基本类型的值

    - 没有: 则调用 toString(); 进行强制类型转换

2) 若 valueOf(); & toString(); 都没有返回基本类型的值, 则抛出 TypeError


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// es5 之后, 使用 Object.create(null); 创建的对象的 prorotype = null, 并且没有 valueOf(); & toString();

let arr = Object.create(null);


console.log(ar.prorotype);          // null

arr.toString();                     // TypeError
arr.valueOf();                      // TypeError


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

### ToBoolean();

#### introduction

```javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * ToBoolean();
 *
 *
 * 负责处理将非字符串类型 强制转换为 布尔值
 */


// 除假值之外的值强制类型转换都为 真值

- false: undefined, null, false, 0, -0, NaN, ""

- true: other


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


ToBoolean(1);               // true
ToBoolean(0);               // false


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### object to boolean

```javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// 将假值封装为对象

let bool = new Boolean(false),
  zero = new Number(0),
  str = new String('');

console.log(Boolean(bool, zero, str)); // true


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


document.all; // 部分浏览器已废弃


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

## explicit

#### introduction

```javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// 显式类型转换


Number();
String();
Boolean();


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// 一元表达式 & Number();

let str = "520";

+str;


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// toString();

let num = 520;

num.toString(); -> const n = new Number(num); -> n.toString();
                          ( 包装类 )


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// new Date(); -> 时间戳( number )


// es5 之前

let +timestamp = new Date();        // 获取时间戳

    // (new Date()).getTime();
    // (new Date).getTime();


// es5

let timestamp = Date.now();         // 获取时间戳


// finally

if(!Date.now) {

    Date.now = () => (+new Date());
}


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### ~ vs Math.floor();

```javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


～: 返回 2 的补码          // 仅适用于 32 位的整数


1) 将字符转换为 32 位

2) 再将所有字符 取反( ! )


~x = -(x + 1);


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// 抽象滲漏

let a = 'hello world';

if(a.indexOf('lo') >= 0) {          // true
    // 找到匹配
}

if(a.indexOf('lo') != -1) {         // true
    // 找到匹配
}

if(a.indexOf('ol') < 0) {           // true
    // 未找到匹配
}

if(a.indexOf('ol') == -1) {         // true
    // 未找到匹配
}



~a.indexOf('lo');                   // -4       true

if(~a.indexOf('lo')) {              // true
    // 找到匹配
}

~a.indexOf('ol');                   // 0        false

!~a.indexOf('ol');                  // true

if(~a.indexOf('ol')) {              // true
    // 未找到匹配
}


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


~~ vs Math.floor();


// ~~

1) 执行 ToInt32 并反转字符,

2) 再次进行字位反转


// Math.floor();


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// 将值截取为一个 32 位的整数( 仅适用于 32 位的数字 )

~~num；=== num | 0;


//-------------------------------------------------------------------------------------------------------------------//


|:


0 | -0;             // 0
0 | NaN;            // 0
0 | Infinity        // 0
0 | -Infinity       // 0


//-------------------------------------------------------------------------------------------------------------------//


!:







///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### Number(); vs parseInt();

```javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// 解析 vs 转换: 两者关系不可互相替代


// 解析: 字符串右侧的字符不影响结果即可

    允许字符串中函数非数字字符, 解析按从左到右的顺序, 若遇到非数字字符及停止

    而转换不允许出现非数字字符, 否则会解析失败并返回 NaN


// 转换: 必须都是数字

    若字符串右边的非数字自负欧不影响结果, 则可以适用解析         // eg: '520px'

    而转换要求字符串中所有的字符都是数字


//-------------------------------------------------------------------------------------------------------------------//


/**
 * parseInt(string, radix?): number;
 * parseFloat(string, radix?): number;
 *
 *
 * @radix:
 *
 *      -  es5之前: 需传递该参数指定传入字符串以什么进制转换
 *
 *      -  es5: 默认转换为 10 进制
 */


若传入的参数并非是 string, 则会隐式强制转换为 string 后再继续解析


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### Boolean();

```javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


Boolean(anyVal)  === !!anyVal;


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// 若判断条件不是布尔值, js 会自动调用 ToBoolean 转换为 布尔值


if (Boolean(condition)) {       
}


let res = Boolean(condition) ? 'val1' : 'val2';


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### someType( anotherType( anyType ) )

```javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


// SomeType -> AnotherType -> SomeType


显式强制类型转换: 逻辑清晰, 代码冗余

隐式强制类型转换: 逻辑需要理解, 精简代码


//-------------------------------------------------------------------------------------------------------------------//


// to String


anyType + '' === String(anyType) === anyType.toString();

toString();
valueOf();
...


//-------------------------------------------------------------------------------------------------------------------//


// to Number


+anyType === Number(anyType);

parseInt();
parseFloat();
...


//-------------------------------------------------------------------------------------------------------------------//


// to Boolean


!anyType === Boolean(anyType);
!!anyType === Boolean(anyType);


// condition: 会被隐式转换为 boolean 值再做判断
if(condition) {}
for(;condtion;;) {}
while(condition){}
condition? : ;
...

//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// ||

[statement1]: true || [statement2]: true => statement1(): any;

[statement1]: false || [statement2]: true => statement2(): any;


// &&

[statement1]: true && [statement2]: true => statement2(): any;

[statement1]: false && [statement2]: true => statement1(): any;


//-------------------------------------------------------------------------------------------------------------------//


// symbol();

es6 允许 symbol 显式强制类型转换

但是 隐式强制类型转换会产生错误 


//-------------------------------------------------------------------------------------------------------------------//



[] + {};            // [object Object]

{} + [];            // 0

[2] - [1];          // 1

![];                // false

!{};                // false


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### == & ===

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


==: 需要类型检查

两边的值中有 true | false | [] | '' | 0 则避免使用  ==


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


string == number;                           // ToNumber(string);

boolean == number | string;                 // ToNumber(boolean);

object == string | number;                  // ToPrimitive(object) -> valueOf(); -> toString();


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


// 不要轻易改变内置构造函数的 valueOf(); toString();
// 否则在类型转换的时候可能会出错


1) change valueOf();

Number.prototype.valueOf = funcution() {
    return 6;
};

new Number(9) == 6;         // true


2) change valueOf();

let i = 2;

Number.prorotype.valueOf = funcution() {
    return i++;
};

if(a == 2 && a == 3) {      // true
}


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


'0' == null;                // false
'0' == undefined;           // false
'0' == false;               // true             *
'0' == NaN;                 // false
'0' == 0;                   // true
'0' == '';                  // false


false == null;              // false
false == undefined;         // false
false == NaN;               // false
false == 0;                 // true             *
false == '';                // true             *
false == [];                // true             *
false == {};                // false


'' == null;                 // false
'' == undefined;            // false
'' == NaN;                  // false
'' == 0;                    // true             *
'' == [];                   // true             *
'' == {};                   // false


0 == null;                  // false
0 == undefined;             // false
0 == NaN;                   // false
0 == [];                    // true             *
0 == {};                    // false


[] == ![];                  // true
2 == [2];                   // true
'' == [null];               // true             *
0 == '\n';                  // true


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


'0' == false;               // true
false == 0;                 // true
false == '';                // true
false == [];                // true
'' == 0;                    // true
'' == [];                   // true
0 == [];                    // true


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//




//-------------------------------------------------------------------------------------------------------------------//


// ===

可能会隐式类型转换


//-------------------------------------------------------------------------------------------------------------------//


NaN != NaN
NaN !== NaN

+0 == -0
+0 === -0

null == undefined;


//-------------------------------------------------------------------------------------------------------------------//


// == vs ===

使用相同的算法, 性能差别细微, 考虑是否会产生 隐式类型转换


//-------------------------------------------------------------------------------------------------------------------//






///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```